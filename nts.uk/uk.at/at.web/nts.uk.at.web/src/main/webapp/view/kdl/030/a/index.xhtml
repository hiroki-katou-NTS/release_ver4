<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:com="http://xmlns.jcp.org/jsf/component"
	xmlns:h="http://xmlns.jcp.org/jsf/html">
<body>
	<ui:composition template="../../../../master/dialog.xhtml">
		<ui:define name="htmlHead">
			<com:ValidatorScript>
				nts.uk.ctx.at.request.dom.setting.company.mailsetting.mailapplicationapproval.ApplicationEmailBody
			</com:ValidatorScript>
			<script>var dialogSize = { width: 870, height: 620 };</script>
			<com:scriptfile set="IGNITE" />
			<com:scriptfile path="kdl030.a.start.js" />
			<com:scriptfile path="kdl030.a.vm.js" />
			<com:scriptfile path="kdl030.a.service.js" />
			<com:stylefile path="kdl030.a.main.css" />
		</ui:define>
		<ui:define name="content">
			
			<div id="contents-area" style="width: 850px; height: 620px">
				<!-- A1_1 承認者にメールを送信します。 -->
				<div class="label-div">
					<label>#{i18n.getText('KDL030_2')}</label>
				</div>
				<div class="table valign-center">
					<div class="cell">
						<!-- A2_1 送信対象者 -->
						<div id="A2_1" style="width: 100px;"
							data-bind="ntsFormLabel: { required: true }">#{i18n.getText('KDL030_3')}</div>
					</div>
					<div id = "A2_2">
						<table id="table-phase">
						<thead>
							<tr style = "background-color: #E0F59E !important ">
								<th class="phase-app">#{i18n.getText('KDL030_10')}</th>
								<th class="order-app">#{i18n.getText('KDL030_11')}</th>
								<th class="name-app">#{i18n.getText('KDL030_12')}</th>
								<th class="status-app">#{i18n.getText('KDL030_13')}</th>
								<th class="isMail-appr">#{i18n.getText('KDL030_14')}</th>
							</tr>
						</thead>
						<tbody data-bind="foreach: {data :approvalRootState, as: 'loopPhase' }">
							<!-- 1 フェーズ -->
							<com:ko-foreach bind="{data : $data.listApprovalFrame, as :'loopFrame'}">
								<tr>
									<com:ko bind="$index() === 0" tag="if">
										<td data-bind="attr: {rowspan: $parent.listApprovalFrame.length}, text: '#{i18n.getText('KDL030_15')}'+$parent.phaseOrder" 
											class="bg-green phase-app"></td>
									</com:ko>
									<com:ko bind= "loopPhase.listApprovalFrame.length = 1" tag ="if">
										<!-- 承認者 -->
											<td data-bind="text: $vm.getApproverLabel($data.frameOrder)" class="order-app bg-green" ></td>
										<!-- 社員名 -->
										<td class = "name-app" data-bind="foreach: $data.listApprover">
											<div class = "rowPerName" data-bind="css: { rowBorder:  ($parent.listApprover.length - $index()) > 1 }">
												<div class = "nameApprover" data-bind="text: $data.dispApproverName"></div>
											</div>
										</td>
									</com:ko>		<!-- 状況 -->
									<td class = "status-app" data-bind="text: approvalAtrName" ></td>
 									<!-- メール送信 -->
 									<td class = "isMail-appr" data-bind="foreach: $data.listApprover">
 										<div data-bind = "if: $data.showButton,
 												css: {rowBorder: ($parent.listApprover.length - $index()) > 1 &amp; showButton, rowPer: showButton}">
	 										<div data-bind="ntsSwitchButton: { 
			   										name: '#{i18n.getText('KAF030_25')}',   
			   										options: $parents[2].optionList,   
			  										optionsValue: 'dispCode',  
			  										optionsText: 'dispName',  
			  										value: $data.isSend}">
	  										</div>
 										</div>
 										<div data-bind = "ifnot: $data.showButton, 
 											css: {rowBorder: ($parent.listApprover.length - $index()) > 1 &amp; showButton == false, 
 													rowPer1: showButton == false }">#{i18n.getText('KDL030_31')}</div>
									</td>
								</tr>
							</com:ko-foreach>
						</tbody>
					</table>
					</div>
				</div>
				<div class="table valign-center" style = "padding-top: 10px">
					<div class="cell">
						<!-- A3_1 申請者 -->
						<div id="A3_1" style="width: 100px;"
							data-bind="ntsFormLabel: { required: true }">#{i18n.getText('KDL030_32')}</div>
					</div>
					<div id="A3_2">
						<table id="table-applicant">
							<thead>
								<tr class="bg-green">
									<th class="applicant">#{i18n.getText('KDL030_33')}</th>
									<!-- A3_2_2 -->
									<th class="name-emp">#{i18n.getText('KDL030_35')}</th>
									<th class="isMail-app">#{i18n.getText('KDL030_14')}</th>
								</tr>
							</thead>
							<tbody>
								<tr data-bind="with: applicantObj">
									<!-- A3_2_4 申請者（ラベル） -->
									<td class="applicant bg-green">#{i18n.getText('KDL030_34')}</td>
									<!-- A3_2_5 社員名 -->
									<td class = "name-emp" data-bind="text: empName"></td>
									<!-- メール送信 -->
									<td class = "isMail-app">
										<div data-bind = "if: isMail">
											<div data-bind="ntsSwitchButton: { 
			   										name: '#{i18n.getText('KAF030_25')}',   
			   										options: $parent.optionList,   
			  										optionsValue: 'dispCode',  
			  										optionsText: 'dispName',  
			  										value: $parent.isSendToApplicant}">
											</div>
										</div>
										<div data-bind = "ifnot : isMail, css:{rowPer1: isMail == false}">#{i18n.getText('KDL030_31')}</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="table valign-center">
				</div>
				<div class="table valign-center">
					<div class="cell">
						<div id="A4_1" class="column1"
							data-bind="ntsFormLabel: { required : true,  constraint: 'ApplicationEmailBody' }">#{i18n.getText('KDL030_6')}</div>
					</div>
					<div class="cell column2">
						<textarea id="A4_2"
							data-bind="ntsMultilineEditor: { 
									name: '#[KDL034_14]',
									value: mailContent,
									required : true,
									constraint: 'ApplicationEmailBody' }" />
					</div>
				</div>
			</div>
			<div id="functions-area-bottom">
				<button  class="x-large proceed"
					data-bind="click: sendMail, enable: $root.errors.isEmpty">#{i18n.getText('KDL030_8')}</button>
				<button data-bind="click: cancel">#{i18n.getText('KDL030_9')}</button>
			</div>
		</ui:define>
	</ui:composition>
</body>
</html>